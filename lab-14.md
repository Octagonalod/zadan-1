[Перелік усіх робіт](README.md)

## Доступ до сторінок та аналіз даних за допомогою регулярних виразів

## Мета роботи

Створити PHP-програму, яка б завантажувала веб-сторінку з сайту
gismeteo.ua, аналізувала б її та виводила інформацію про тривалість
світлого часу доби, а також денної температури на свою веб-сторінку. Додати
цю програму на свій сайт та поставити на неї посилання з головної сторінки сайту. Оцінка
за виконану роботу може бути підвищена за умови надання короткого та
красивий вихідний текст програми.

## Обладнання

## Хід роботи

1. Сайт gismeteo.ua (малюнок 1) надає користувачам прогнози погоди.

Малюнок 1- Сайт gismeteo.ua
![Малюнок 1- Сайт gismeteo.ua](/lab-14-files/img-1.png)

Ваша програма має завантажити прогноз погоди для міста Харкова (посилання
http://www.gismeteo.ua/city/hourly/5053/) та вивести на свою веб-сторінку
наступну інформацію: назва міста (взяти з веб-сторінки, отриманої від
gismeteo.ua), поточну дату (теж взяти з сайту), час сходу та заходу сонця,
тривалість світлого часу доби, а також прогноз температури на 0, 3, 6, 9, 12, 15,
18 та 21 год (див. малюнок 2).

<image
  src="/lab-14-files/img-2.png"
  alt="Текст с описанием картинки"
  caption="Рисунок 2 - Веб-страница, которая загружает и анализирует информацию с gismeteo.ua">

Рисунок 2 - Веб-страница, которая загружает и анализирует информацию с gismeteo.ua

  
  
  
  
  
  
Зверніть увагу на те, щоб ваша програма виводила слова “година”, “години”,
"годин" у потрібному відмінку залежно від конкретної тривалості дня.
Наприклад, "1 година" або "3 години" або "8 годин".
Якщо, як у цьому прикладі, тривалість дня становить цілу кількість
годин, то програма повинна виводити напис: "рівно X годин", де X - кількість
годин. Якщо не ціле, то виводити напис: "X годин Y хв", де Y - кількість хвилин.
 
2. Замініть у програмі посилання
"http://www.gismeteo.ua/city/hourly/5053/" на посилання
"http://www.gismeteo.ua/city/hourly/4944/" (прогноз погоди для міста
Київ). Перевірте, чи правильно працює ваша програма в цьому випадку (див. малюнок 3).   

![](lab-14-files\img-3)
Малюнок 3 - Ця ж сторінка, але обробна прогноз погоди для м. Київ

Методичні вказівки:
Для запиту на сайт використовуйте функції PHP curl_setopt(), curl_exec() та curl_close(). 
Наприклад, ось так:
```php
 $curl=curl_init();
 curl_setopt($curl, CURLOPT_URL,
'http://www.gismeteo.ua/city/hourly/5053/');
 curl_setopt ($ curl, CURLOPT_RETURNTRANSFER, true);
 $out = curl_exec($curl);
 ```

Для конвертації отриманого вмісту веб-сторінки з кодування UTF-8
кодування Windows-1251 використовуйте mb_convert_encoding().
На екрані виведіть вихідний код сторінки сайту
http://www.gismeteo.ua/city/hourly/5053/ та знайдіть необхідні
ключові слова (малюнок 4).

![](lab-14-files\img-4)
Рисунок 4 - Приклад вихідного тексту веб-сторінки, яка отримується від сайту gismeteo.ua

Наприклад, час сходу сонця знаходиться у тексті сторінки між фрагментами
тексту “Схід” та ```“<li>”```
Використовуючи регулярні вирази (або написавши свою функцію для пошуку
фрагмента тексту) витягніть із сторінки всю необхідну Вам інформацію.
Наприклад, текст для вилучення зі сторінки інформації про схід сонця може
виглядати приблизно так:
```php
$c = preg_match("/Схід\<\/strong\>.*\<li\>/sU", $out,$a);
 $s=$a[0];
 $l=strlen($s);
 $u=substr($s,16,$l-20);
 echo $u;
 ```
Тут:
```$out```- рядок, в якому у нас міститься текст веб-сторінки, отриманої з
gismeteo.ua.

Схід\<\/strong\> .*\<li\>/sU" - регулярний вираз для пошуку
першого попавшегося фрагмента, що починається з "Схід</strong>" і
закінчується ```“<li>”``` (символи “\” використовуються тут для екранування
службових символів типу "/", "<", ">" та ін).
```php
$s - знайдений фрагмент;
$l - довжина рядка $s;
$u - знайдений фрагмент без "Схід" (16 літер) спочатку і "<li>" (4 літери)
в кінці (всього - $l-20 букв).
```
За подобою витягніть із веб-сторінки всю решту необхідної інформації
(Час заходу, назва міста, дату, прогнози температури).
Для виведення на екран граудсів використовуйте спецсимвол HTML ```“&deg;”.```


## Контрольні питання

1.  Навіщо виконувати валідацію як на серверній стороні так і на стороні браузера?
2.  Для чого використовується функція `strlen()`?
3.  Яка різниця між функціями `fetchColumn()` та `fetchAll()`?
4.  Як можна виконати редирект?
5.  За допомогою якого оператора можна виконати сортування результатів запиту вибірки?
